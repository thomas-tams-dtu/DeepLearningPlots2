"0","PCAD_data_avg_test <- PCAD_data|>"
"0","  mutate(avg_test_loss = unlist(map(.x = test_loss,"
"0","                                    .f = ~mean(.x))),"
"0","         .after =network_name)"
"0",""
"0","PCAD_data |>"
"0","  slice(1) |>"
"0","  pull(test_loss) |>"
"0","  unlist() |>"
"0","  length()"
"1","[1]"
"1"," 134"
"1","
"
"0","lowest_test_PCAD <- PCAD_data_avg_test |>"
"0","  pull(avg_test_loss) |>"
"0","  min()"
"0",""
"0",""
"0","color_vector <- c("
"0","  ""#69BD44"","
"0","  ""#5154A5"", ""#5154A5"","
"0","  ""#41B6E8"", ""#41B6E8"","
"0","  ""#FCE349"", ""#FCE349"", ""#FCE349"","
"0","  ""red"", ""red"", ""red"", ""red"", ""red"", ""red"","
"0","  ""grey"", ""grey"""
"0",")"
"0",""
"0","test_p_PCAD <- PCAD_data_avg_test |>"
"0","  ggplot(aes(x = latent_features, y = weight_decay, fill = avg_test_loss)) +"
"0","  geom_tile() +"
"0","  scale_fill_gradientn(colours=color_vector,"
"0","                       na.value = ""grey"","
"0","                       breaks=c(lowest_test_PCAD, 0.25, 0.32, 0.4, 0.56),"
"0","                       limits=c(lowest_test_PCAD,0.6),"
"0","                       labels = scales::label_number(accuracy = 0.01)) +"
"0","  facet_wrap(~network_size) +"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +"
"0","    labs(title = 'PCA-Dense network performance',"
"0","       subtitle = 'PCA trained on archs4 & Dense network trained on gtex',"
"0","       fill = test_fill_text,"
"0","       x = 'PCA size',"
"0","       y = 'Weight decay')"
"0",""
"0","test_p_PCAD"
